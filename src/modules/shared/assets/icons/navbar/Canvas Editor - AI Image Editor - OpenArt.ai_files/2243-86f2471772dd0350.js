"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2243],{72243:function(e,t,r){r.d(t,{$$:function(){return h},$u:function(){return p},GN:function(){return l},Jr:function(){return d},Lk:function(){return _},Sg:function(){return E},YY:function(){return v},ai:function(){return x},i8:function(){return o},lU:function(){return I},n_:function(){return w},pI:function(){return m},po:function(){return s},qh:function(){return c},qo:function(){return L},td:function(){return f},u3:function(){return A},uV:function(){return g},vE:function(){return R},xJ:function(){return b},yB:function(){return a},zT:function(){return u}});var n=r(71481),i=r(59739);function a(){return(0,i.Z)()}function o(e,t){return t.getObjects().includes(e)}function l(e,t){let r=document.createElement("a");r.href=e,r.download=t,r.click()}function h(e){let t={color:e,alpha:1};if(null==e?void 0:e.startsWith("rgba")){let r=e.match(/rgba\(([^)]+)\)/)[1].split(",");t.color=`rgb(${r[0]}, ${r[1]}, ${r[2]})`,t.alpha=Number.parseFloat(r[3])}return t}function s(e){return new Promise((t,r)=>{let n=new Image;n.crossOrigin="anonymous",n.addEventListener("load",()=>{(n.width>4096||n.height>4096)&&r("Image dimensions exceed the maximum supported size of 4096 pixels."),t(n)}),n.addEventListener("error",()=>{r("Failed to load image. Please check the image URL or network connection.")}),n.src=e})}function c(e){return new Promise(t=>{let r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0),r.toBlob(e=>{t(e)})})}function d(e){let t=e.split(","),r=t[0].match(/:(.*?);/)[1],n=atob(t[1]),i=n.length,a=new Uint8Array(i);for(;i--;)a[i]=n.codePointAt(i);return new Blob([a],{type:r})}r(18536);let g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return await Promise.all(e.map(e=>new Promise(r=>e.clone(e=>{r(t(e))}))))},u=e=>`rgba(22, 216, 102, ${e})`;function m(e){let t=u(.7),r=`<svg xmlns="http://www.w3.org/2000/svg" height="${e}" width="${e}"><circle cx="${e/2}" cy="${e/2}" r="${e/2}" fill="${t}" /></svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(r)}`}function f(e){return`url('${m(e)}') ${e/2} ${e/2}, auto`}let w=e=>`rgba(251, 34, 195, ${e})`;function E(e){let t=w(1),r=`<svg xmlns="http://www.w3.org/2000/svg" height="${e}" width="${e}" viewBox="0 0 ${e} ${e}">
    <circle cx="${e/2}" cy="${e/2}" r="${e/2-2}" fill="none" stroke="${t}" stroke-width="4" />
  </svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(r)}`}function v(e){return`url('${E(e)}') ${e/2} ${e/2}, auto`}async function p(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.width,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.height,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,{width:l,height:h}=e,c=n/l,d=i/h;if(l<=t&&h<=r&&l===n&&h===i&&e instanceof HTMLImageElement)return e.src.startsWith("data:")?[await s(e.src),1*a,1*o]:[e,c*a,d*o];let g=document.createElement("canvas");g.width=n,g.height=i,g.getContext("2d").drawImage(e,0,0,n,i);let u=await s(g.toDataURL()),m=Math.min(t/n,r/i);if(!(m<1))return[await s(g.toDataURL()),c*a,d*o];{let e=document.createElement("canvas"),t=n*m,r=i*m;return e.width=t,e.height=r,e.getContext("2d").drawImage(u,0,0,t,r),[await s(e.toDataURL()),m*c*a,m*d*o]}}let R=e=>new Promise((t,r)=>{let n=document.createElement("input");n.type="file",n.accept="image/*",n.addEventListener("change",n=>{var i;let a=null===(i=n.target.files)||void 0===i?void 0:i[0];if(a){let n=new FileReader;n.addEventListener("load",n=>{try{var i;let r=null===(i=n.target)||void 0===i?void 0:i.result;null==e||e(null,r),t(r)}catch(n){let t=`Error processing file: ${n.message}`;null==e||e(t),r(t)}}),n.addEventListener("error",()=>{let t="Error reading file";null==e||e(t),r(t)}),n.readAsDataURL(a)}else{let t="No file selected";null==e||e(t),r(t)}}),n.addEventListener("close",()=>{let t="File selection was closed";null==e||e(t),r(t)}),n.addEventListener("error",()=>{let t="An error occurred during file selection";null==e||e(t),r(t)}),n.addEventListener("cancel",()=>{let t="User cancelled: File selection was canceled";null==e||e(t),r(t)}),n.click()}),x=async(e,t)=>{let r=document.createElement("canvas"),n=r.getContext("2d");r.width=e.width,r.height=e.height,n.drawImage(e,0,0,r.width,r.height);let i=n.getImageData(0,0,r.width,r.height),a=document.createElement("canvas");a.width=e.width,a.height=e.height;let o=a.getContext("2d");o.drawImage(t,0,0,e.width,e.height);let l=o.getImageData(0,0,e.width,e.height);for(let e=0;e<i.data.length;e+=4){let t=l.data[e+3];i.data[e+3]=255-t}return n.putImageData(i,0,0),r},L=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=t/Math.max(e.width,e.height),i=new n.fabric.StaticCanvas(null,{width:t,height:t});return new Promise(t=>{e.clone(n=>{let a=i.getVpCenter();n.set({scaleX:r,scaleY:r,left:a.x-e.getScaledWidth()*r/2/e.scaleX,top:a.y-e.getScaledHeight()*r/2/e.scaleY,visible:!0}),n.clipPath=null,i.add(n),i.renderAll(),t(i.toDataURL()),i.dispose()})})};async function _(e){return new Promise((t,r)=>{let n=new Blob([e],{type:"image/png"}),i=URL.createObjectURL(n),a=new Image;a.crossOrigin="anonymous",a.addEventListener("load",()=>{(a.width>16e3||a.height>16e3)&&r("Image dimensions exceed the maximum supported size of 16000 pixels."),t(a)}),a.addEventListener("error",()=>{r("Failed to load image. Please check the image URL or network connection.")}),a.src=i})}async function A(e,t,r){let n=new Blob([e],{type:"image/png"}),i=URL.createObjectURL(n),a=await s(i),o=document.createElement("canvas"),l=o.getContext("2d");if(!l)throw Error("Unable to get 2D context");return o.width=Math.round(a.width/t),o.height=Math.round(a.height/r),l.drawImage(a,0,0,o.width,o.height),URL.revokeObjectURL(i),(await new Promise(e=>{o.toBlob(t=>{if(t)e(t);else throw Error("Canvas to Blob conversion failed")},"image/png")})).arrayBuffer()}class T{initShaders(){let e=`
      attribute vec2 a_position;
      attribute vec2 a_texCoord;
      varying vec2 v_texCoord;
      void main() {
        gl_Position = vec4(a_position, 0, 1);
        v_texCoord = a_texCoord;
      }
    `,t=`
      precision mediump float;
      uniform sampler2D u_image;
      varying vec2 v_texCoord;
      void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
      }
    `,r=this.compileShader(e,this.gl.VERTEX_SHADER),n=this.compileShader(t,this.gl.FRAGMENT_SHADER);if(this.program=this.gl.createProgram(),this.gl.attachShader(this.program,r),this.gl.attachShader(this.program,n),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw Error(`Unable to initialize the shader program: ${this.gl.getProgramInfoLog(this.program)}`);this.gl.useProgram(this.program),this.positionLocation=this.gl.getAttribLocation(this.program,"a_position"),this.texCoordLocation=this.gl.getAttribLocation(this.program,"a_texCoord")}compileShader(e,t){let r=this.gl.createShader(t);if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS))throw Error(`An error occurred compiling the shaders: ${this.gl.getShaderInfoLog(r)}`);return r}initBuffers(){this.positionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.gl.STATIC_DRAW),this.texCoordBuffer=this.gl.createBuffer()}drawImage(e,t){let{gl:r}=this;this.canvas.width=t.width,this.canvas.height=t.height,r.viewport(0,0,t.width,t.height);let n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.enableVertexAttribArray(this.positionLocation),r.bindBuffer(r.ARRAY_BUFFER,this.positionBuffer),r.vertexAttribPointer(this.positionLocation,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(this.texCoordLocation),r.bindBuffer(r.ARRAY_BUFFER,this.texCoordBuffer);let i=t.x/e.width,a=t.y/e.height,o=(t.x+t.width)/e.width,l=(t.y+t.height)/e.height;r.bufferData(r.ARRAY_BUFFER,new Float32Array([i,l,o,l,i,a,o,a]),r.STATIC_DRAW),r.vertexAttribPointer(this.texCoordLocation,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLE_STRIP,0,4)}constructor(e){if(this.canvas=e,this.gl=e.getContext("webgl",{premultipliedAlpha:!1}),!this.gl)throw Error("WebGL not supported");this.initShaders(),this.initBuffers()}}function b(e,t){if(!window.WebGLRenderingContext)return new Promise((r,n)=>{let i=document.createElement("canvas");i.width=t.width,i.height=t.height;let a=i.getContext("2d");if(!a){n(Error("Unable to get 2D context from canvas"));return}if(e instanceof HTMLImageElement)a.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);else if(e instanceof HTMLCanvasElement){let r=e.getContext("2d");if(!r){n(Error("Unable to get 2D context from source canvas"));return}let i=r.getImageData(t.x,t.y,t.width,t.height);a.putImageData(i,0,0)}else{n(Error("Invalid source type. Must be HTMLImageElement or HTMLCanvasElement"));return}let o=new Image;o.addEventListener("load",()=>r(o)),o.addEventListener("error",()=>n(Error("Failed to load cropped image"))),o.src=i.toDataURL()});let r=document.createElement("canvas");return new T(r).drawImage(e,t),new Promise(e=>{let t=new Image;t.addEventListener("load",()=>e(t)),t.src=r.toDataURL()})}function I(e,t){let r=new n.fabric.Point(e.x,e.y),i=t instanceof HTMLCanvasElement?t.getBoundingClientRect():t;return r.x-=i.left,r.y-=i.top,r}}}]);