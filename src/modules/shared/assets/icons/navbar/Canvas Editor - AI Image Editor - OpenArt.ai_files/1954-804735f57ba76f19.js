"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1954],{41954:function(e,t,a){a.d(t,{BU:function(){return Y},BV:function(){return b},D:function(){return y},EQ:function(){return Q},K9:function(){return D},Mx:function(){return K},NO:function(){return J},PU:function(){return I},Q0:function(){return W},Ym:function(){return c},Z9:function(){return h},am:function(){return p},cQ:function(){return M},dn:function(){return R},fZ:function(){return F},hL:function(){return T},jy:function(){return G},on:function(){return Z},pB:function(){return H},qV:function(){return V},qY:function(){return k},rX:function(){return x},tO:function(){return B},wN:function(){return C},x$:function(){return f},x5:function(){return m},zD:function(){return g}});var r=a(75271),n=a(21617),o=a(13200),s=a(48299),l=a(28337),i=a(22289);let u=async e=>(await l.ZP.post("workflows/publish",e)).data,c=(0,l.py)(u,{onSuccess:()=>{}}),w=async e=>(await l.ZP.post("workflows/edit",e)).data,f=(0,l.py)(w,{onSuccess:()=>{}}),d=async e=>(await l.ZP.post("workflows/delete",e)).data,p=(0,l.py)(d,{onSuccess:()=>{}}),y=e=>{let{query_type:t,category:a,custom_node:r,user_id:o,is_my_self:s,sort:i,is_liked:u,keyword:c,enabled:w=!0}=e,f=async e=>{let{pageParam:n}=e;return(await l.ZP.get(new l.Rx("/workflows/list",{cursor:n,query_type:t,category:a,custom_node:r,user_id:o,is_my_self:s,sort:i,is_liked:u,keyword:c}).toString())).data||[]},{data:d,...p}=(0,n.N)(["useWorkflows",t,a,r,i,u,s,o,c],f,{getNextPageParam:e=>e.nextCursor,enabled:w});return{data:null==d?void 0:d.pages.flatMap(e=>e.items),...p}},g=e=>{let{category:t,custom_node:a,sort:r="trending",keyword:o,days:s=1,enabled:i=!0}=e,u=async e=>{let{pageParam:n}=e;return(await l.ZP.get(new l.Rx("/workflows/search",{cursor:n,category:t,custom_node:a,sort:r,keyword:o,days:s}).toString())).data||[]},{data:c,...w}=(0,n.N)(["useSearchWorkflows",t,a,r,o,s],u,{getNextPageParam:e=>e.nextCursor,enabled:i});return{data:null==c?void 0:c.pages.flatMap(e=>e.items),...w}},k=e=>{let{keyword:t,enabled:a}=e,r=async e=>{let{pageParam:a}=e;return(await l.ZP.get(new l.Rx("/workflows/spotlight_creations",{keyword:t,cursor:a}).toString())).data||[]},{data:o,...s}=(0,n.N)(["useSpotlightCreationsWorkflows",t],r,{getNextPageParam:e=>e.nextCursor,enabled:a});return{data:null==o?void 0:o.pages.flatMap(e=>e.items),...s}},h=e=>{let{enabled:t}=e,a=async e=>{let{pageParam:t}=e;return(await l.ZP.get(new l.Rx("/workflows/followings",{cursor:t}).toString())).data||[]},{data:r,...o}=(0,n.N)(["useFollowingsWorkflows"],a,{getNextPageParam:e=>e.nextCursor,enabled:t});return{data:null==r?void 0:r.pages.flatMap(e=>e.items),...o}},P=async e=>{let t=["O54Z4dTTT2Xcpe1GNEIy"].includes(e.workflow_id)?"workflows/create":"workflows/api_create";return(await l.ZP.post(t,e)).data},m=(0,l.py)(P,{onSuccessWithQueryClient:e=>{e.invalidateQueries([i.uE]),e.refetchQueries(["useGenerationHistories"])}}),S=async e=>(await l.ZP.post("workflows/reviews/add_rating",e)).data,Z=(0,l.py)(S,{refetchKeysOnSuccess:["useWorkflowBySlug","useWorkflowReviews"]}),_=async e=>(await l.ZP.post("workflows/reviews/add_comment",e)).data,b=(0,l.py)(_,{refetchKeysOnSuccess:["useWorkflowReviews"]}),v=async e=>(await l.ZP.post("workflows/reviews/add_comment_reply",e)).data,x=(0,l.py)(v,{refetchKeysOnSuccess:["useWorkflowReviews"]}),C=e=>{let{workflow_id:t,limit:a}=e,r=async e=>{let{pageParam:r}=e;return(await l.ZP.get(`/workflows/reviews/list?workflow_id=${t}&cursor=${r||""}&limit=${a||0}`)).data||[]},{data:o,...s}=(0,n.N)(["useWorkflowReviews",t],r,{getNextPageParam:e=>e.nextCursor,enabled:!!t});return{data:null==o?void 0:o.pages.flatMap(e=>e.items),...s}},N=async e=>(await l.ZP.post("workflows/like",e)).data,W=(0,l.py)(N,{refetchKeysOnSuccess:["useWorkflowBySlug"]}),L=async e=>(await l.ZP.post("workflows/toggle_public",e)).data,R=(0,l.py)(L,{onSuccess:()=>{}}),$=async e=>{let t=await l.ZP.post("workflows/download",e),{filename:a,payload:r}=t.data,n=new Blob([r]),o=window.URL.createObjectURL(n),s=document.createElement("a");return s.href=o,s.setAttribute("download",`${a}.json`),document.body.append(s),s.click(),s.remove(),t.data},Q=(0,l.py)($,{onSuccess:()=>{}}),O=async e=>(await l.ZP.post("workflows/download_asset",e)).data,D=(0,l.py)(O,{onSuccess:()=>{}}),E=async e=>(await l.ZP.post("workflows/flow_app/publish",e)).data,M=(0,l.py)(E,{onSuccess:()=>{}}),T=e=>{let{workflow_id:t}=e,a=async()=>(await l.ZP.get(`/workflows/flow_app/generation_time?workflow_id=${t}`)).data||[];return(0,o.a)(["useFlowAppGenerationTime",t],a,{enabled:!!t})},j=async e=>(await l.ZP.post("workflows/flow_app/update_online",e)).data,B=(0,l.py)(j,{onSuccess:()=>{}}),A=async e=>(await l.ZP.post("workflows/flow_app/update_featured",e)).data,K=(0,l.py)(A,{onSuccess:()=>{}}),U=async e=>(await l.ZP.post("workflows/flow_app/update_metadata",e)).data,F=(0,l.py)(U,{onSuccess:()=>{}}),G=()=>{let e=async()=>(await l.ZP.get("workflows/storage/files/tree")).data||[],{data:t,...a}=(0,o.a)(["useStorages"],e,{enabled:!0}),n=e=>{if(!e)return[];for(let t of e)(null==t?void 0:t.children)&&(t.children=n(t.children));let t=e.sort((e,t)=>e.label.toLocaleLowerCase()<t.label.toLocaleLowerCase()?-1:e.label.toLocaleLowerCase()<t.label.toLocaleLowerCase()?1:0);return t.forEach((e,a)=>{"shared"===e.id&&(t.splice(a,1),t.unshift(e))}),t};return{data:(0,r.useMemo)(()=>n(t),[t]),...a}},q=async e=>{let t=await l.ZP.get(`workflows/storage/files/${e}`);return{id:e,items:t.data||[]}},V=(0,l.py)(q,{onSuccessWithQueryClient:(e,t)=>{let{id:a,items:r}=t;e.setQueryData(["useStorages"],e=>{let t=(0,s.j)(e,a);if(!t)return e;(null==t?void 0:t.children)||(t.children=[]);let n=[];for(let e of r){let{id:a}=e,r=e;for(let n=0;n<t.children.length;n++){let o=t.children[n];if(o.id===a){r={...o,...e};break}}n.push(r)}return t.children=n,[...e]})}}),X=async e=>{let t=await l.ZP.delete(`workflows/storage/files/${e}`);return{id:e,data:t.data}},Y=(0,l.py)(X,{onSuccessWithQueryClient:(e,t)=>{let{id:a}=t;e.setQueryData(["useStorages"],e=>{let t=(e,a)=>{if(e)for(let r=0;r<e.length;r++){let n=e[r];if(n.id===a){e.splice(r,1);break}(null==n?void 0:n.children)&&t(n.children,a)}};return t(e,a),[...e]})}}),z=async e=>{let{path:t,name:a}=e;return(await l.ZP.post(`workflows/storage/folder/create/${t}`,{name:a})).data},H=(0,l.py)(z),I=(e,t)=>{let a=async()=>(await l.ZP.get(`workflows/storage/files/${e}`)).data||[],{data:r,...n}=(0,o.a)(["useFolderDetails",e],a,{enabled:t});return{data:(r??[]).sort((e,t)=>{let a=new Date(e.mtime).getTime();return new Date(t.mtime).getTime()-a}),...n}},J=async(e,t)=>{fetch(`${location.origin}/api/workflows/storage/files/upload`,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/octet-stream"}}).then(e=>{let a=e.body.getReader(),r=t.getWriter();a.read().then(async function e(t){let{done:n,value:o}=t;if(n){r.write("close-stream"),r.close();return}return await r.write(o),a.read().then(e)})})}},48299:function(e,t,a){a.d(t,{j:function(){return r}});let r=(e,t)=>{for(let a of e){let{id:e,children:n}=a;if(e===t)return a;if(n&&Array.isArray(n)){let e=r(n,t);if(e)return e}}return null}}}]);